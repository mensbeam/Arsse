# N.B. the unix:/var/run/php/php7.2-fpm.sock path used repeatedly below will 
#      vary from system to system and will be probably need to be changed

<VirtualHost *:80>
    ServerName localhost
    # adjust according to your installation path
    DocumentRoot /usr/share/arsse/www

    # adjust according to your installation path
    ProxyFCGISetEnvIf "true" SCRIPT_FILENAME "/usr/share/arsse/arsse.php"
    ProxyPreserveHost On

    # Nextcloud News v1.2, Tiny Tiny RSS API, TT-RSS newsfeed icons, Miniflux API
    <LocationMatch "(/index\.php/apps/news/api/?.+|/tt-rss/(api|feed-icons)|/v1/)">
        ProxyPass "unix:/var/run/php/php7.2-fpm.sock|fcgi://localhost/usr/share/arsse"
    </LocationMatch>

    # Nextcloud News API detection, Fever API, Miniflux miscellanies
    <LocationMatch "(/index\.php/apps/news/api/?$|/fever|/version$|/healthcheck$)">
        # these locations should not be behind HTTP authentication
        ProxyPass "unix:/var/run/php/php7.2-fpm.sock|fcgi://localhost/usr/share/arsse"
    </LocationMatch>
</VirtualHost>
