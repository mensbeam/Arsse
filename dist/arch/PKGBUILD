pkgname="arsse"
pkgver="0.9.1"
pkgrel=1
epoch=
pkgdesc="RSS/Atom newsfeed synchronization server"
arch=("any")
url="https://thearsse.com/"
license=("MIT")
groups=()
depends=()
makedepends=()
checkdepends=()
optdepends=("php-pgsql: PostgreSQL database support")
provides=()
conflicts=()
replaces=()
backup=("etc/webapps/arsse/config.php" "etc/php/php-fpm.d/arsse.conf")
options=()
install=
changelog=
source=("https://thearsse.com/releases/0.9.0.tar.gz"
        "arsse.service"
        "arsse-fetch.service"
        "sysuser.conf"
        "config.php"
        "php-fpm.conf"
        "arsse.sh")
noextract=()

package() {
    depends=("php" "php-intl" "php-sqlite" "php-fpm")
    cd "$pkgdir"
    mkdir -p "usr/bin" "usr/share/webapps/arsse" "usr/share/doc/arsse" "usr/share/licenses/arsse" "usr/lib/systemd/system" "usr/lib/sysusers.d" "etc/webapps/arsse" "etc/php/php-fpm.d/"
    cd "$srcdir/arsse"
    cp ../arsse.sh "$pkgdir/usr/bin/arsse"
    cp -r lib locale sql vendor www CHANGELOG UPGRADING README.md arsse.php "$pkgdir/usr/share/webapps/arsse"
    cp -r manual/* "$pkgdir/usr/share/doc/arsse"
    cp LICENSE AUTHORS "$pkgdir/usr/share/licenses/arsse"
    cp ../*.service "$pkgdir/usr/lib/systemd/system"
    cp ../sysuser.conf "$pkgdir/usr/lib/sysusers.d/arsse.conf"
    cp ../config.php config.defaults.php "$pkgdir/etc/webapps/arsse"
    cp ../php-fpm.conf "$pkgdir/etc/php/php-fpm.d/arsse.conf"
    cd "$pkgdir"
    chmod -R a=rX *
    chmod a=rx usr/bin/arsse
    chmod u=r etc/webapps/arsse/*
    ln -sT "/etc/webapps/arsse/config.php" "usr/share/webapps/arsse/config.php"
}
md5sums=('93327083c316daf879c70921189ed7b6'
         '91871736d9594b2c92d1fa6b6e4f2803'
         '0ca05e2965247d4651a986aad81d80e1'
         'b6ef9ab7e9062df1d5ba060066b6d734'
         '33e7a5b290ef20339952f1d904b33f8f'
         '943d35272b0aa7af2bf3818a0c9bd5fc'
         '4fb46ec290e497279c3dd7c8c528abf6')
